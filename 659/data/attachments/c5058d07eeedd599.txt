INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     jubilant:_juju.py:237 cli: juju ssh --model test-cas cassandra/0 hostname
INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     jubilant:_juju.py:237 cli: juju secrets --model test-cas --format json
INFO     jubilant:_juju.py:237 cli: juju show-secret --model test-cas --reveal --format json d6f5bm66f2fcg1p9sar0
INFO     integration.helpers.juju:juju.py:76 revealed secret d6f5bm66f2fcg1p9sar0: {"d6f5bm66f2fcg1p9sar0":{"revision":1,"checksum":"715d8fcf17a8d1ea85ce12db77f058dca2879da59d9fb831279b9a294f1e05af","owner":"cassandra","label":"cassandra-peers.cassandra.app","created":"2026-02-25T01:53:59Z","updated":"2026-02-25T01:53:59Z","content":{"Data":{"internal-ca-key-secret":"-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAwcn90XTofQaI+e0vKSlgcE042ZytHbdGjOWle1xO+jMphfCH\nRhNielYOukxmuo3JYGkpMOKP9nI+W80tyJdsf1lot2wXHJ9lApjI/Etv7zvQaOXn\nMfqCucnqUcaQQ21iKRwgdbic6AsgFf0Lkok2Ett1Q1Lt5cIFyHlPLPs7Xmic3EPH\nDUwAcH+A1O4hdP8blVIZlW/bPg0Q8CnHuDSQnS0whlwlymgSu4UZLxPuA54dBIqy\nW9W1sbegvw0vuI3HX3ADtrUkGNwyo0fAYQpYWzcID2v4lBO0e90G3UHKvHLdpb4x\nqwPMOm9yFTcNgzl32nsnBU9LasvpcPEqtxADbQIDAQABAoIBABKjag9dcmfl+0Io\ncw7/LQiYEMXzSP4w7K7r/nLDMdBkH9QDSottnVzdTozSANZkATCN5LmQLN775W4A\naa0fjT6hW446re1hkj5B8iC746/rfZO9OvOGX9DdL/V+Bs2JZXXFQAT6hNLXkRY0\nUIrfOg1twJVBUmK0+sfpjPkrT644cBzWbRT9hRqcFRH4npJUUR7XsH3N5cZ+5gvZ\npEXch9caQLOr9S93ViiS4ulajwSVGNMMv3cRJRDwvOlpF+ObalKVq+dQf5yHL+EN\nmHub1k6oChpVK4wnwDUsanQVVCEsAMyIzTTZf7iB+yfYRElXdDqfCH37X+pBtz5t\nLECEUWECgYEA7tAAC276lbQeNh783/GSTdyhivwRPsny7EcAUf6q9TsBuP3R9zxa\nzwLOSim6D1CeskmfnxS5r9hIWCIUenA7uYrAKIVslHExh7smP+up5HylXtNUTMDt\n09vDUQquU/H7UTmqqiAemFPwWM9ylNcBhLfnJLk4luJHDjJt1Qeic6ECgYEAz7x0\n4QmV5f52KP0hiLY1CFIoQ2cQQ3j/yw5nqlHZD1yFSuwHASlmPAn7F20E+Ly4WKQM\ntpV61KwrEX51xt7QOWOok58BjPaT4HTo+dCc+yJuVjHLv4zK3fp4veUGDDWsHUU2\n/F9mSpfZd+PMsLxkuUmeKwMZw/3gvD/9GSmpvE0CgYEA6kS9Znnt9CGHaYwogP8X\niK4hApiXykKNvV9BXy42Qu8pl3HXIXPhmSWlfHdGgHOT2k4C+il4ppnDDkIQWLP0\nwuTr8FRC2bPY5M+gjCAAv5XPHCCvl8PDCouRJNUXgl3lLh8l3lI38TKWmmiWfJAW\nez100D+q1ckP70tlFw+wO0ECgYEAto4+BFlBIso5GpJA+vxspHBWs80JrNHTsKVr\nEnE1GFvNQ2ciTLIOBusafp6uxMxMEJGyHm5EcEsQ2iHQ7MB4KkbbKUeNvEwg7hqv\ndoIOwl+iqRq/nAjlaqennfF7HBW6uEpQJP7NTPYfBU3qXtJgjbgVSGVEKkmcSrLN\nAGTtpe0CgYEA6BD38MpiAuvFOzzuFWGHTvfD9TCGcyDBiPezYjA5jHZUwucVQi9p\nQWvV5S5TnW2E22RUqNG6yeznLq0GEMpaQ2LVmVsKnjF6k3Au2CcSgq7R5iANA5jp\nR7++cR9EWngSA2TCznQWoyOBTha1MMwYaDkAUiJ3Ba1O0dVihR3CosQ=\n-----END RSA PRIVATE KEY-----","internal-ca-secret":"-----BEGIN CERTIFICATE-----\nMIIDdDCCAlygAwIBAgIUEWiRscrnnpFUZVhd+RKBYxSfidowDQYJKoZIhvcNAQEL\nBQAwUjESMBAGA1UEAwwJY2Fzc2FuZHJhMS0wKwYDVQQtDCQ2NjFjYTQ3NC0xOGNh\nLTQwOWItYmY4MC0xODYyNGI3OTY0NDQxDTALBgNVBAoMBHBlZXIwHhcNMjYwMjI1\nMDE1MjI0WhcNMzYwMjIzMDE1MjI0WjBSMRIwEAYDVQQDDAljYXNzYW5kcmExLTAr\nBgNVBC0MJDY2MWNhNDc0LTE4Y2EtNDA5Yi1iZjgwLTE4NjI0Yjc5NjQ0NDENMAsG\nA1UECgwEcGVlcjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMHJ/dF0\n6H0GiPntLykpYHBNONmcrR23RozlpXtcTvozKYXwh0YTYnpWDrpMZrqNyWBpKTDi\nj/ZyPlvNLciXbH9ZaLdsFxyfZQKYyPxLb+870Gjl5zH6grnJ6lHGkENtYikcIHW4\nnOgLIBX9C5KJNhLbdUNS7eXCBch5Tyz7O15onNxDxw1MAHB/gNTuIXT/G5VSGZVv\n2z4NEPApx7g0kJ0tMIZcJcpoEruFGS8T7gOeHQSKslvVtbG3oL8NL7iNx19wA7a1\nJBjcMqNHwGEKWFs3CA9r+JQTtHvdBt1Byrxy3aW+MasDzDpvchU3DYM5d9p7JwVP\nS2rL6XDxKrcQA20CAwEAAaNCMEAwHQYDVR0OBBYEFMtU2XjggIQpvcUr6cAQ+0fk\nHXGrMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgKkMA0GCSqGSIb3DQEB\nCwUAA4IBAQAJfIcc9vkjt7e8iDLMdPPllKJ6OQQ1kkhz8BenVg71B6m99cql2wud\nzF4VVi5JTKY6Pyv5unYHd/G8JBjLrsltH82rwZrn1fyB6YjERkm8Srh9bv8+rldc\nFu3+6wIFSChzveDMgznVzDfyuZaK+JW/SErYzecrULHHYd5BpCAiKgRahgbQA3h1\nA3QFtUoIZ78QhTyOLUq4QHwE37vr3EcsPrZuZQ4InNRqySdAeh/aENFxguuZsAmH\n9rrdia6KBm5iS/Ww8E8mUIX16IDPDDQH1yasbzBNa8yyEb0aloxiFi5IqiNkProc\n/w6Ovl6o6Cy+aq3QSP5MHpwm+BKj76im\n-----END CERTIFICATE-----","operator-password":"awGYRRopu0wN5WUU689pbGopSzIRM1MT"}}}}

INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.6.153.189:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     integration.test_network:test_network.py:63 Waiting for unit to go down
INFO     jubilant.wait:_juju.py:982 wait: status changed:
+ .model.name = 'test-cas'
+ .model.type = 'iaas'
+ .model.controller = 'concierge-lxd'
+ .model.cloud = 'localhost'
+ .model.version = '3.6.14'
+ .model.region = 'localhost'
+ .model.model_status.current = 'available'
+ .machines['0'].juju_status.current = 'started'
+ .machines['0'].juju_status.version = '3.6.14'
+ .machines['0'].hostname = 'juju-b44950-0'
+ .machines['0'].dns_name = '10.6.153.189'
+ .machines['0'].ip_addresses[0] = '10.6.153.189'
+ .machines['0'].instance_id = 'juju-b44950-0'
+ .machines['0'].machine_status.current = 'running'
+ .machines['0'].machine_status.message = 'Running'
+ .machines['0'].modification_status.current = 'applied'
+ .machines['0'].base.name = 'ubuntu'
+ .machines['0'].base.channel = '24.04'
+ .machines['0'].network_interfaces['eth0'].ip_addresses[0] = '10.6.153.189'
+ .machines['0'].network_interfaces['eth0'].mac_address = '00:16:3e:29:82:b6'
+ .machines['0'].network_interfaces['eth0'].is_up = True
+ .machines['0'].network_interfaces['eth0'].gateway = '10.6.153.1'
+ .machines['0'].network_interfaces['eth0'].space = 'alpha'
+ .machines['0'].constraints = 'arch=amd64'
+ .machines['0'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmwffz4 virt-type=container'
+ .machines['1'].juju_status.current = 'started'
+ .machines['1'].juju_status.version = '3.6.14'
+ .machines['1'].hostname = 'juju-b44950-1'
+ .machines['1'].dns_name = '10.6.153.101'
+ .machines['1'].ip_addresses[0] = '10.6.153.101'
+ .machines['1'].instance_id = 'juju-b44950-1'
+ .machines['1'].machine_status.current = 'running'
+ .machines['1'].machine_status.message = 'Running'
+ .machines['1'].modification_status.current = 'applied'
+ .machines['1'].base.name = 'ubuntu'
+ .machines['1'].base.channel = '24.04'
+ .machines['1'].network_interfaces['eth0'].ip_addresses[0] = '10.6.153.101'
+ .machines['1'].network_interfaces['eth0'].mac_address = '00:16:3e:eb:30:ba'
+ .machines['1'].network_interfaces['eth0'].is_up = True
+ .machines['1'].network_interfaces['eth0'].gateway = '10.6.153.1'
+ .machines['1'].network_interfaces['eth0'].space = 'alpha'
+ .machines['1'].constraints = 'arch=amd64'
+ .machines['1'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmwffz4 virt-type=container'
+ .machines['2'].juju_status.current = 'started'
+ .machines['2'].juju_status.version = '3.6.14'
+ .machines['2'].hostname = 'juju-b44950-2'
+ .machines['2'].dns_name = '10.6.153.52'
+ .machines['2'].ip_addresses[0] = '10.6.153.52'
+ .machines['2'].instance_id = 'juju-b44950-2'
+ .machines['2'].machine_status.current = 'running'
+ .machines['2'].machine_status.message = 'Running'
+ .machines['2'].modification_status.current = 'applied'
+ .machines['2'].base.name = 'ubuntu'
+ .machines['2'].base.channel = '24.04'
+ .machines['2'].network_interfaces['eth0'].ip_addresses[0] = '10.6.153.52'
+ .machines['2'].network_interfaces['eth0'].mac_address = '00:16:3e:9b:3e:27'
+ .machines['2'].network_interfaces['eth0'].is_up = True
+ .machines['2'].network_interfaces['eth0'].gateway = '10.6.153.1'
+ .machines['2'].network_interfaces['eth0'].space = 'alpha'
+ .machines['2'].constraints = 'arch=amd64'
+ .machines['2'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmwffz4 virt-type=container'
+ .apps['cassandra'].charm = 'local:cassandra-0'
+ .apps['cassandra'].charm_origin = 'local'
+ .apps['cassandra'].charm_name = 'cassandra'
+ .apps['cassandra'].charm_rev = 0
+ .apps['cassandra'].exposed = False
+ .apps['cassandra'].base.name = 'ubuntu'
+ .apps['cassandra'].base.channel = '24.04'
+ .apps['cassandra'].app_status.current = 'active'
+ .apps['cassandra'].relations['bootstrap'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['bootstrap'][0].interface = 'rolling_op'
+ .apps['cassandra'].relations['bootstrap'][0].scope = 'global'
+ .apps['cassandra'].relations['cassandra-peers'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['cassandra-peers'][0].interface = 'cassandra_peers'
+ .apps['cassandra'].relations['cassandra-peers'][0].scope = 'global'
+ .apps['cassandra'].relations['refresh-v-three'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['refresh-v-three'][0].interface = 'refresh'
+ .apps['cassandra'].relations['refresh-v-three'][0].scope = 'global'
+ .apps['cassandra'].units['cassandra/0'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/0'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/0'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/0'].leader = True
+ .apps['cassandra'].units['cassandra/0'].machine = '0'
+ .apps['cassandra'].units['cassandra/0'].public_address = '10.6.153.189'
+ .apps['cassandra'].units['cassandra/1'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/1'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/1'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/1'].machine = '1'
+ .apps['cassandra'].units['cassandra/1'].public_address = '10.6.153.101'
+ .apps['cassandra'].units['cassandra/2'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/2'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/2'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/2'].machine = '2'
+ .apps['cassandra'].units['cassandra/2'].public_address = '10.6.153.52'
+ .apps['cassandra'].version = '5.0.5'
+ .apps['cassandra'].endpoint_bindings[''] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['bootstrap'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cassandra-client'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cassandra-peers'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['client-certificates'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cos-agent'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['peer-certificates'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['refresh-v-three'] = 'alpha'
+ .storage.storage['data/0'].kind = 'filesystem'
+ .storage.storage['data/0'].status.current = 'attached'
+ .storage.storage['data/0'].persistent = False
+ .storage.storage['data/0'].life = 'alive'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].machine = '0'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].life = 'alive'
+ .storage.storage['data/1'].kind = 'filesystem'
+ .storage.storage['data/1'].status.current = 'attached'
+ .storage.storage['data/1'].persistent = False
+ .storage.storage['data/1'].life = 'alive'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].machine = '1'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].life = 'alive'
+ .storage.storage['data/2'].kind = 'filesystem'
+ .storage.storage['data/2'].status.current = 'attached'
+ .storage.storage['data/2'].persistent = False
+ .storage.storage['data/2'].life = 'alive'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].machine = '2'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].life = 'alive'
+ .storage.filesystems['0/0'].size = 147718
+ .storage.filesystems['0/0'].provider_id = '0/0'
+ .storage.filesystems['0/0'].storage = 'data/0'
+ .storage.filesystems['0/0'].attachments.machines['0'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['0/0'].attachments.machines['0'].read_only = False
+ .storage.filesystems['0/0'].attachments.machines['0'].life = 'alive'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].machine = '0'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].life = 'alive'
+ .storage.filesystems['0/0'].pool = 'rootfs'
+ .storage.filesystems['0/0'].life = 'alive'
+ .storage.filesystems['0/0'].status.current = 'attached'
+ .storage.filesystems['1/1'].size = 147718
+ .storage.filesystems['1/1'].provider_id = '1/1'
+ .storage.filesystems['1/1'].storage = 'data/1'
+ .storage.filesystems['1/1'].attachments.machines['1'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['1/1'].attachments.machines['1'].read_only = False
+ .storage.filesystems['1/1'].attachments.machines['1'].life = 'alive'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].machine = '1'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].life = 'alive'
+ .storage.filesystems['1/1'].pool = 'rootfs'
+ .storage.filesystems['1/1'].life = 'alive'
+ .storage.filesystems['1/1'].status.current = 'attached'
+ .storage.filesystems['2/2'].size = 147718
+ .storage.filesystems['2/2'].provider_id = '2/2'
+ .storage.filesystems['2/2'].storage = 'data/2'
+ .storage.filesystems['2/2'].attachments.machines['2'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['2/2'].attachments.machines['2'].read_only = False
+ .storage.filesystems['2/2'].attachments.machines['2'].life = 'alive'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].machine = '2'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].life = 'alive'
+ .storage.filesystems['2/2'].pool = 'rootfs'
+ .storage.filesystems['2/2'].life = 'alive'
+ .storage.filesystems['2/2'].status.current = 'attached'
INFO     jubilant.wait:_juju.py:982 wait: status changed:
- .apps['cassandra'].units['cassandra/0'].leader = True
- .apps['cassandra'].units['cassandra/1'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/1'].workload_status.current = 'maintenance'
+ .apps['cassandra'].units['cassandra/1'].workload_status.message = 'repairing system_auth keyspace'
- .apps['cassandra'].units['cassandra/2'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/2'].workload_status.current = 'maintenance'
+ .apps['cassandra'].units['cassandra/2'].workload_status.message = 'repairing system_auth keyspace'
+ .apps['cassandra'].units['cassandra/2'].leader = True
INFO     jubilant.wait:_juju.py:982 wait: status changed:
- .machines['0'].juju_status.current = 'started'
+ .machines['0'].juju_status.current = 'down'
+ .machines['0'].juju_status.message = 'agent is not communicating with the server'
- .apps['cassandra'].units['cassandra/0'].workload_status.current = 'active'
- .apps['cassandra'].units['cassandra/0'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/0'].workload_status.current = 'unknown'
+ .apps['cassandra'].units['cassandra/0'].workload_status.message = "agent lost, see 'juju show-status-log cassandra/0'"
+ .apps['cassandra'].units['cassandra/0'].juju_status.current = 'lost'
+ .apps['cassandra'].units['cassandra/0'].juju_status.message = 'agent is not communicating with the server'
INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     integration.test_network:test_network.py:87 Checking: cassandra/1 if node 10.6.153.189 is down
INFO     jubilant:_juju.py:237 cli: juju ssh --model test-cas cassandra/1 'sudo snap run charmed-cassandra.nodetool status'
INFO     integration.test_network:test_network.py:87 Checking: cassandra/2 if node 10.6.153.189 is down
INFO     jubilant:_juju.py:237 cli: juju ssh --model test-cas cassandra/2 'sudo snap run charmed-cassandra.nodetool status'
INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.6.153.101:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
WARNING  cassandra.cluster:thread.py:58 Failed to create connection pool for new host 10.6.153.189:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3234, in cassandra.cluster.Session.add_or_renew_pool.run_add_or_renew_pool
  File "cassandra/pool.py", line 406, in cassandra.pool.HostConnection.__init__
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 846, in cassandra.connection.Connection.factory
  File "/root/spread_project/.tox/integration-network/lib/python3.12/site-packages/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 951, in cassandra.connection.Connection._connect_socket
OSError: [Errno None] Tried connecting to [('10.6.153.189', 9042)]. Last error: timed out
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.6.153.52:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
WARNING  cassandra.cluster:thread.py:58 Failed to create connection pool for new host 10.6.153.189:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3234, in cassandra.cluster.Session.add_or_renew_pool.run_add_or_renew_pool
  File "cassandra/pool.py", line 406, in cassandra.pool.HostConnection.__init__
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 846, in cassandra.connection.Connection.factory
  File "/root/spread_project/.tox/integration-network/lib/python3.12/site-packages/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 951, in cassandra.connection.Connection._connect_socket
OSError: [Errno None] Tried connecting to [('10.6.153.189', 9042)]. Last error: timed out
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.6.153.52:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
WARNING  cassandra.cluster:thread.py:58 Failed to create connection pool for new host 10.6.153.189:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3234, in cassandra.cluster.Session.add_or_renew_pool.run_add_or_renew_pool
  File "cassandra/pool.py", line 406, in cassandra.pool.HostConnection.__init__
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 846, in cassandra.connection.Connection.factory
  File "/root/spread_project/.tox/integration-network/lib/python3.12/site-packages/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 951, in cassandra.connection.Connection._connect_socket
OSError: [Errno None] Tried connecting to [('10.6.153.189', 9042)]. Last error: timed out
INFO     integration.helpers.continuous_writes:continuous_writes.py:134 continuous writes min=1, max=535, pcount=535
INFO     jubilant.wait:_juju.py:982 wait: status changed:
+ .model.name = 'test-cas'
+ .model.type = 'iaas'
+ .model.controller = 'concierge-lxd'
+ .model.cloud = 'localhost'
+ .model.version = '3.6.14'
+ .model.region = 'localhost'
+ .model.model_status.current = 'available'
+ .machines['0'].juju_status.current = 'started'
+ .machines['0'].juju_status.version = '3.6.14'
+ .machines['0'].hostname = 'juju-b44950-0'
+ .machines['0'].dns_name = '10.6.153.189'
+ .machines['0'].ip_addresses[0] = '10.6.153.189'
+ .machines['0'].instance_id = 'juju-b44950-0'
+ .machines['0'].machine_status.current = 'running'
+ .machines['0'].machine_status.message = 'Running'
+ .machines['0'].modification_status.current = 'applied'
+ .machines['0'].base.name = 'ubuntu'
+ .machines['0'].base.channel = '24.04'
+ .machines['0'].network_interfaces['eth0'].ip_addresses[0] = '10.6.153.189'
+ .machines['0'].network_interfaces['eth0'].mac_address = '00:16:3e:29:82:b6'
+ .machines['0'].network_interfaces['eth0'].is_up = True
+ .machines['0'].network_interfaces['eth0'].gateway = '10.6.153.1'
+ .machines['0'].network_interfaces['eth0'].space = 'alpha'
+ .machines['0'].constraints = 'arch=amd64'
+ .machines['0'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmwffz4 virt-type=container'
+ .machines['1'].juju_status.current = 'started'
+ .machines['1'].juju_status.version = '3.6.14'
+ .machines['1'].hostname = 'juju-b44950-1'
+ .machines['1'].dns_name = '10.6.153.101'
+ .machines['1'].ip_addresses[0] = '10.6.153.101'
+ .machines['1'].instance_id = 'juju-b44950-1'
+ .machines['1'].machine_status.current = 'running'
+ .machines['1'].machine_status.message = 'Running'
+ .machines['1'].modification_status.current = 'applied'
+ .machines['1'].base.name = 'ubuntu'
+ .machines['1'].base.channel = '24.04'
+ .machines['1'].network_interfaces['eth0'].ip_addresses[0] = '10.6.153.101'
+ .machines['1'].network_interfaces['eth0'].mac_address = '00:16:3e:eb:30:ba'
+ .machines['1'].network_interfaces['eth0'].is_up = True
+ .machines['1'].network_interfaces['eth0'].gateway = '10.6.153.1'
+ .machines['1'].network_interfaces['eth0'].space = 'alpha'
+ .machines['1'].constraints = 'arch=amd64'
+ .machines['1'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmwffz4 virt-type=container'
+ .machines['2'].juju_status.current = 'started'
+ .machines['2'].juju_status.version = '3.6.14'
+ .machines['2'].hostname = 'juju-b44950-2'
+ .machines['2'].dns_name = '10.6.153.52'
+ .machines['2'].ip_addresses[0] = '10.6.153.52'
+ .machines['2'].instance_id = 'juju-b44950-2'
+ .machines['2'].machine_status.current = 'running'
+ .machines['2'].machine_status.message = 'Running'
+ .machines['2'].modification_status.current = 'applied'
+ .machines['2'].base.name = 'ubuntu'
+ .machines['2'].base.channel = '24.04'
+ .machines['2'].network_interfaces['eth0'].ip_addresses[0] = '10.6.153.52'
+ .machines['2'].network_interfaces['eth0'].mac_address = '00:16:3e:9b:3e:27'
+ .machines['2'].network_interfaces['eth0'].is_up = True
+ .machines['2'].network_interfaces['eth0'].gateway = '10.6.153.1'
+ .machines['2'].network_interfaces['eth0'].space = 'alpha'
+ .machines['2'].constraints = 'arch=amd64'
+ .machines['2'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmwffz4 virt-type=container'
+ .apps['cassandra'].charm = 'local:cassandra-0'
+ .apps['cassandra'].charm_origin = 'local'
+ .apps['cassandra'].charm_name = 'cassandra'
+ .apps['cassandra'].charm_rev = 0
+ .apps['cassandra'].exposed = False
+ .apps['cassandra'].base.name = 'ubuntu'
+ .apps['cassandra'].base.channel = '24.04'
+ .apps['cassandra'].app_status.current = 'active'
+ .apps['cassandra'].relations['bootstrap'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['bootstrap'][0].interface = 'rolling_op'
+ .apps['cassandra'].relations['bootstrap'][0].scope = 'global'
+ .apps['cassandra'].relations['cassandra-peers'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['cassandra-peers'][0].interface = 'cassandra_peers'
+ .apps['cassandra'].relations['cassandra-peers'][0].scope = 'global'
+ .apps['cassandra'].relations['refresh-v-three'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['refresh-v-three'][0].interface = 'refresh'
+ .apps['cassandra'].relations['refresh-v-three'][0].scope = 'global'
+ .apps['cassandra'].units['cassandra/0'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/0'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/0'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/0'].machine = '0'
+ .apps['cassandra'].units['cassandra/0'].public_address = '10.6.153.189'
+ .apps['cassandra'].units['cassandra/1'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/1'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/1'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/1'].machine = '1'
+ .apps['cassandra'].units['cassandra/1'].public_address = '10.6.153.101'
+ .apps['cassandra'].units['cassandra/2'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/2'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/2'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/2'].leader = True
+ .apps['cassandra'].units['cassandra/2'].machine = '2'
+ .apps['cassandra'].units['cassandra/2'].public_address = '10.6.153.52'
+ .apps['cassandra'].version = '5.0.5'
+ .apps['cassandra'].endpoint_bindings[''] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['bootstrap'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cassandra-client'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cassandra-peers'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['client-certificates'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cos-agent'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['peer-certificates'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['refresh-v-three'] = 'alpha'
+ .storage.storage['data/0'].kind = 'filesystem'
+ .storage.storage['data/0'].status.current = 'attached'
+ .storage.storage['data/0'].persistent = False
+ .storage.storage['data/0'].life = 'alive'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].machine = '0'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].life = 'alive'
+ .storage.storage['data/1'].kind = 'filesystem'
+ .storage.storage['data/1'].status.current = 'attached'
+ .storage.storage['data/1'].persistent = False
+ .storage.storage['data/1'].life = 'alive'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].machine = '1'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].life = 'alive'
+ .storage.storage['data/2'].kind = 'filesystem'
+ .storage.storage['data/2'].status.current = 'attached'
+ .storage.storage['data/2'].persistent = False
+ .storage.storage['data/2'].life = 'alive'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].machine = '2'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].life = 'alive'
+ .storage.filesystems['0/0'].size = 147718
+ .storage.filesystems['0/0'].provider_id = '0/0'
+ .storage.filesystems['0/0'].storage = 'data/0'
+ .storage.filesystems['0/0'].attachments.machines['0'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['0/0'].attachments.machines['0'].read_only = False
+ .storage.filesystems['0/0'].attachments.machines['0'].life = 'alive'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].machine = '0'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].life = 'alive'
+ .storage.filesystems['0/0'].pool = 'rootfs'
+ .storage.filesystems['0/0'].life = 'alive'
+ .storage.filesystems['0/0'].status.current = 'attached'
+ .storage.filesystems['1/1'].size = 147718
+ .storage.filesystems['1/1'].provider_id = '1/1'
+ .storage.filesystems['1/1'].storage = 'data/1'
+ .storage.filesystems['1/1'].attachments.machines['1'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['1/1'].attachments.machines['1'].read_only = False
+ .storage.filesystems['1/1'].attachments.machines['1'].life = 'alive'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].machine = '1'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].life = 'alive'
+ .storage.filesystems['1/1'].pool = 'rootfs'
+ .storage.filesystems['1/1'].life = 'alive'
+ .storage.filesystems['1/1'].status.current = 'attached'
+ .storage.filesystems['2/2'].size = 147718
+ .storage.filesystems['2/2'].provider_id = '2/2'
+ .storage.filesystems['2/2'].storage = 'data/2'
+ .storage.filesystems['2/2'].attachments.machines['2'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['2/2'].attachments.machines['2'].read_only = False
+ .storage.filesystems['2/2'].attachments.machines['2'].life = 'alive'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].machine = '2'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].life = 'alive'
+ .storage.filesystems['2/2'].pool = 'rootfs'
+ .storage.filesystems['2/2'].life = 'alive'
+ .storage.filesystems['2/2'].status.current = 'attached'
INFO     jubilant:_juju.py:237 cli: juju ssh --model test-cas cassandra/0 'sudo snap run charmed-cassandra.nodetool status'
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.6.153.189:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.6.153.52:9042 datacenter1> discovered
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.6.153.101:9042 datacenter1> discovered
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.6.153.189:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.6.153.52:9042 datacenter1> discovered
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.6.153.101:9042 datacenter1> discovered
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.6.153.189:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.6.153.52:9042 datacenter1> discovered
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.6.153.101:9042 datacenter1> discovered
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
INFO     integration.helpers.continuous_writes:continuous_writes.py:134 continuous writes min=1, max=883, pcount=883
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.6.153.189:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.6.153.52:9042 datacenter1> discovered
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.6.153.101:9042 datacenter1> discovered
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
INFO     integration.helpers.continuous_writes:continuous_writes.py:134 continuous writes min=1, max=883, pcount=883
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.6.153.101:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes