INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     jubilant:_juju.py:237 cli: juju ssh --model test-cas cassandra/0 hostname
INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     jubilant:_juju.py:237 cli: juju secrets --model test-cas --format json
INFO     jubilant:_juju.py:237 cli: juju show-secret --model test-cas --reveal --format json d6hpkk74cocci6agmv2g
INFO     integration.helpers.juju:juju.py:76 revealed secret d6hpkk74cocci6agmv2g: {"d6hpkk74cocci6agmv2g":{"revision":1,"checksum":"2880fb936c18979772e67cc4235123273f0d099574aa884aa534b35ab5829700","owner":"cassandra","label":"cassandra-peers.cassandra.app","created":"2026-03-01T01:47:30Z","updated":"2026-03-01T01:47:30Z","content":{"Data":{"internal-ca-key-secret":"-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAqiTrjBuE7y7K2/oLFWxhWEbjn+c7Jdn2exVegfIRiiAI0op7\nLGuxLSU1XddcZImGq1Z5Aak7f3R+h2oreJsxhZtyfuVfHc5RWXjODsRELHvplQ01\nMW9H7hJRGhTX+bdPoc/THN/+NspT5XPRYWl7G5yXeKyS6cjix5ikYdBbbVtKjZzV\npGS0ftG6Xr0eMzxZl2wuqXw4hdYk4mHQHbw9ii7AvOfitdezsFponvb42/I3Onti\n0RKYB8Zi+U9Zbb2IR6rPt21cBvTZmQcs5qs15+VN4J3GC1E4driL+cwNs6/knd/y\nuafQ1ZhC3yZrrd2+IDja70pmFVMedx4XPzyyaQIDAQABAoIBAAWm99WkW8uhVSph\n7MI8fG7IRH522hae3mR5q4I4HMzz1WJljzcRnDKifY3qRJHvcqdlYw9papLu0Qql\n5FKCBbvJRynmUn0lC6IXOtf8cHWLQUSxfWHXL0wxbhUAE8OvMaIWJOgc6Qizbhf3\nIfT+CGtJdEu7oFH+//xyLb9oT1BugOsl1vNGOf/UOZ1a9KXqW7GuUSdN7zi9ncJK\ntMsJDmCfjIuj0kkXwnUG6fPGc4rQ4OnxIq0GrfQ78H7jT4l+M34Y+HMuZOFIITM3\nnWUP1RUBk4qZGNoBtyefpVhEBOnsNUapbao+OOKmJcWvbHBZ2ZRVMqiBgayIwi98\nW9jNBd0CgYEA7d4NveepfCzLuER6hFzLfEm+n1isCvgoaQ+fi76j8bUtK1wGqEaw\n+51uROiaQDtkbjkDv/obvhLkJ5hKdZKoDSSSoA3ixmhI1tS8L9l04XnT5dMLXpvC\nvikFOg2/fRI/Zg4oGRI0B5tUmKq8PlajBh4o8YbntPw1paFmHxKCM7UCgYEAtx1C\nQ1GFJtQ47dnTvdDv6fHxWvDagrYbE3DTk80SeWkPZEO3fQ5eIAPB40bwNLZmD74O\nVLEAV8PT+6gQK11YipgB83/vQ+Uvu0gIhy/ujoMq6TGT5z6HC4cuiPrW8VneabST\nG47U3d99ozpk+h4sMAXr7ou30du85C3EUuJsnGUCgYBwqPtZNp/PcGgMnmJozoqS\nE1t1nUne6Co7mGq4hVKg6G68WpnMma65fZb8jC6CvZ6Tle1wv8TkAY6OMlMR3KQ7\nlVbc97awwjO9jISVJSl2oXz7HToFVUCnUEZpeJl5Y2sjqxDSzwxVjfxDUppV7DLK\ncv5xZrPXxJykFg2IKfwBAQKBgQC2EFBW8JHMNovX6ZG/FCPGXnmT6w/HkNrA7Jhh\nRy/MKWpVTYL9wzBQ8otvt5OTRZuaoWRMTqTBnoKBn+tbwncLbfHasmQqBJD9y7Q2\n/bBaYA5lR5b//8pz6teY+JaH58vdG958MvpxFAouJhxKF3/ly612Q9LjxHA+C0c9\nBcXphQKBgAH/Pcm190Wh8pX1lUL7NHj+z6Sxssd0jxVdUVY5EwcrOJuIHx1e8pD2\ns+aCRpFmI0AQ+Lo9r3mSzGp/uWq/QFmDsliHCU5XI8E8UTbb8EfWRi1pNRLojs7Q\nVtf2vNLdMc8+pnSIPecMS9H4fFwBH6NYORrYsvhUcVfDSHhonWBn\n-----END RSA PRIVATE KEY-----","internal-ca-secret":"-----BEGIN CERTIFICATE-----\nMIIDdDCCAlygAwIBAgIUOPyDidrFnzZIZMrE4PpzVb/b0jAwDQYJKoZIhvcNAQEL\nBQAwUjESMBAGA1UEAwwJY2Fzc2FuZHJhMS0wKwYDVQQtDCQzYWE2ODczMy0xNGVm\nLTQwOTUtYWFmMS1hYjcwYWE4NDUyZWExDTALBgNVBAoMBHBlZXIwHhcNMjYwMzAx\nMDE0NTUxWhcNMzYwMjI3MDE0NTUxWjBSMRIwEAYDVQQDDAljYXNzYW5kcmExLTAr\nBgNVBC0MJDNhYTY4NzMzLTE0ZWYtNDA5NS1hYWYxLWFiNzBhYTg0NTJlYTENMAsG\nA1UECgwEcGVlcjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKok64wb\nhO8uytv6CxVsYVhG45/nOyXZ9nsVXoHyEYogCNKKeyxrsS0lNV3XXGSJhqtWeQGp\nO390fodqK3ibMYWbcn7lXx3OUVl4zg7ERCx76ZUNNTFvR+4SURoU1/m3T6HP0xzf\n/jbKU+Vz0WFpexucl3iskunI4seYpGHQW21bSo2c1aRktH7Rul69HjM8WZdsLql8\nOIXWJOJh0B28PYouwLzn4rXXs7BaaJ72+NvyNzp7YtESmAfGYvlPWW29iEeqz7dt\nXAb02ZkHLOarNeflTeCdxgtROHa4i/nMDbOv5J3f8rmn0NWYQt8ma63dviA42u9K\nZhVTHnceFz88smkCAwEAAaNCMEAwHQYDVR0OBBYEFDmHitYg8WrwU5BYAlit4Yoe\noUF8MA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgKkMA0GCSqGSIb3DQEB\nCwUAA4IBAQAGo4ZdF8OKZQVzVNJsYoBgAc+PHwmJw05kP/IhYUptehLdbYof0dzY\nfPDV3XRMeHAOJyISYhEgmzPhHkZVb4eBLXyJkTSiqgVVIi5oyuCMc662gdt0h8n4\n3FdnJSem4MgxJr6S0TnrO4gHcgDwB0oai92wyuB6YrndQQ0vziu96JOvpA/8Ju1T\nZ/wFKLQNHDiQhkRb1i33qI2/pZt4WkfPB23jcQqLHaGLb6aYI5N6bGaqPD1siJB8\nZAw1BNxj8lIYB6vBwKxCJg9oDc80lYNljjL7v536nymP4nx0IawZAsPNe455j4oa\nWbUF0P72bbvevdm5TOUnN/23N219TZV5\n-----END CERTIFICATE-----","operator-password":"wjttClVqcBzRA3YnGDQ606v7KpviGYIC"}}}}

INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.17.192.141:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     integration.test_network:test_network.py:63 Waiting for unit to go down
INFO     jubilant.wait:_juju.py:982 wait: status changed:
+ .model.name = 'test-cas'
+ .model.type = 'iaas'
+ .model.controller = 'concierge-lxd'
+ .model.cloud = 'localhost'
+ .model.version = '3.6.14'
+ .model.region = 'localhost'
+ .model.model_status.current = 'available'
+ .machines['0'].juju_status.current = 'started'
+ .machines['0'].juju_status.version = '3.6.14'
+ .machines['0'].hostname = 'juju-7b13ce-0'
+ .machines['0'].dns_name = '10.17.192.69'
+ .machines['0'].ip_addresses[0] = '10.17.192.69'
+ .machines['0'].instance_id = 'juju-7b13ce-0'
+ .machines['0'].machine_status.current = 'running'
+ .machines['0'].machine_status.message = 'Running'
+ .machines['0'].modification_status.current = 'applied'
+ .machines['0'].base.name = 'ubuntu'
+ .machines['0'].base.channel = '24.04'
+ .machines['0'].network_interfaces['eth0'].ip_addresses[0] = '10.17.192.69'
+ .machines['0'].network_interfaces['eth0'].mac_address = '00:16:3e:f2:47:dd'
+ .machines['0'].network_interfaces['eth0'].is_up = True
+ .machines['0'].network_interfaces['eth0'].gateway = '10.17.192.1'
+ .machines['0'].network_interfaces['eth0'].space = 'alpha'
+ .machines['0'].constraints = 'arch=amd64'
+ .machines['0'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmnay03 virt-type=container'
+ .machines['1'].juju_status.current = 'started'
+ .machines['1'].juju_status.version = '3.6.14'
+ .machines['1'].hostname = 'juju-7b13ce-1'
+ .machines['1'].dns_name = '10.17.192.106'
+ .machines['1'].ip_addresses[0] = '10.17.192.106'
+ .machines['1'].instance_id = 'juju-7b13ce-1'
+ .machines['1'].machine_status.current = 'running'
+ .machines['1'].machine_status.message = 'Running'
+ .machines['1'].modification_status.current = 'applied'
+ .machines['1'].base.name = 'ubuntu'
+ .machines['1'].base.channel = '24.04'
+ .machines['1'].network_interfaces['eth0'].ip_addresses[0] = '10.17.192.106'
+ .machines['1'].network_interfaces['eth0'].mac_address = '00:16:3e:56:93:e5'
+ .machines['1'].network_interfaces['eth0'].is_up = True
+ .machines['1'].network_interfaces['eth0'].gateway = '10.17.192.1'
+ .machines['1'].network_interfaces['eth0'].space = 'alpha'
+ .machines['1'].constraints = 'arch=amd64'
+ .machines['1'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmnay03 virt-type=container'
+ .machines['2'].juju_status.current = 'started'
+ .machines['2'].juju_status.version = '3.6.14'
+ .machines['2'].hostname = 'juju-7b13ce-2'
+ .machines['2'].dns_name = '10.17.192.141'
+ .machines['2'].ip_addresses[0] = '10.17.192.141'
+ .machines['2'].instance_id = 'juju-7b13ce-2'
+ .machines['2'].machine_status.current = 'running'
+ .machines['2'].machine_status.message = 'Running'
+ .machines['2'].modification_status.current = 'applied'
+ .machines['2'].base.name = 'ubuntu'
+ .machines['2'].base.channel = '24.04'
+ .machines['2'].network_interfaces['eth0'].ip_addresses[0] = '10.17.192.141'
+ .machines['2'].network_interfaces['eth0'].mac_address = '00:16:3e:4e:ee:80'
+ .machines['2'].network_interfaces['eth0'].is_up = True
+ .machines['2'].network_interfaces['eth0'].gateway = '10.17.192.1'
+ .machines['2'].network_interfaces['eth0'].space = 'alpha'
+ .machines['2'].constraints = 'arch=amd64'
+ .machines['2'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmnay03 virt-type=container'
+ .apps['cassandra'].charm = 'local:cassandra-0'
+ .apps['cassandra'].charm_origin = 'local'
+ .apps['cassandra'].charm_name = 'cassandra'
+ .apps['cassandra'].charm_rev = 0
+ .apps['cassandra'].exposed = False
+ .apps['cassandra'].base.name = 'ubuntu'
+ .apps['cassandra'].base.channel = '24.04'
+ .apps['cassandra'].app_status.current = 'active'
+ .apps['cassandra'].relations['bootstrap'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['bootstrap'][0].interface = 'rolling_op'
+ .apps['cassandra'].relations['bootstrap'][0].scope = 'global'
+ .apps['cassandra'].relations['cassandra-peers'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['cassandra-peers'][0].interface = 'cassandra_peers'
+ .apps['cassandra'].relations['cassandra-peers'][0].scope = 'global'
+ .apps['cassandra'].relations['refresh-v-three'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['refresh-v-three'][0].interface = 'refresh'
+ .apps['cassandra'].relations['refresh-v-three'][0].scope = 'global'
+ .apps['cassandra'].units['cassandra/0'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/0'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/0'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/0'].leader = True
+ .apps['cassandra'].units['cassandra/0'].machine = '0'
+ .apps['cassandra'].units['cassandra/0'].public_address = '10.17.192.69'
+ .apps['cassandra'].units['cassandra/1'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/1'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/1'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/1'].machine = '1'
+ .apps['cassandra'].units['cassandra/1'].public_address = '10.17.192.106'
+ .apps['cassandra'].units['cassandra/2'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/2'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/2'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/2'].machine = '2'
+ .apps['cassandra'].units['cassandra/2'].public_address = '10.17.192.141'
+ .apps['cassandra'].version = '5.0.5'
+ .apps['cassandra'].endpoint_bindings[''] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['bootstrap'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cassandra-client'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cassandra-peers'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['client-certificates'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cos-agent'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['peer-certificates'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['refresh-v-three'] = 'alpha'
+ .storage.storage['data/0'].kind = 'filesystem'
+ .storage.storage['data/0'].status.current = 'attached'
+ .storage.storage['data/0'].persistent = False
+ .storage.storage['data/0'].life = 'alive'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].machine = '0'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].life = 'alive'
+ .storage.storage['data/1'].kind = 'filesystem'
+ .storage.storage['data/1'].status.current = 'attached'
+ .storage.storage['data/1'].persistent = False
+ .storage.storage['data/1'].life = 'alive'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].machine = '1'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].life = 'alive'
+ .storage.storage['data/2'].kind = 'filesystem'
+ .storage.storage['data/2'].status.current = 'attached'
+ .storage.storage['data/2'].persistent = False
+ .storage.storage['data/2'].life = 'alive'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].machine = '2'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].life = 'alive'
+ .storage.filesystems['0/0'].size = 147718
+ .storage.filesystems['0/0'].provider_id = '0/0'
+ .storage.filesystems['0/0'].storage = 'data/0'
+ .storage.filesystems['0/0'].attachments.machines['0'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['0/0'].attachments.machines['0'].read_only = False
+ .storage.filesystems['0/0'].attachments.machines['0'].life = 'alive'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].machine = '0'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].life = 'alive'
+ .storage.filesystems['0/0'].pool = 'rootfs'
+ .storage.filesystems['0/0'].life = 'alive'
+ .storage.filesystems['0/0'].status.current = 'attached'
+ .storage.filesystems['1/1'].size = 147718
+ .storage.filesystems['1/1'].provider_id = '1/1'
+ .storage.filesystems['1/1'].storage = 'data/1'
+ .storage.filesystems['1/1'].attachments.machines['1'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['1/1'].attachments.machines['1'].read_only = False
+ .storage.filesystems['1/1'].attachments.machines['1'].life = 'alive'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].machine = '1'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].life = 'alive'
+ .storage.filesystems['1/1'].pool = 'rootfs'
+ .storage.filesystems['1/1'].life = 'alive'
+ .storage.filesystems['1/1'].status.current = 'attached'
+ .storage.filesystems['2/2'].size = 147718
+ .storage.filesystems['2/2'].provider_id = '2/2'
+ .storage.filesystems['2/2'].storage = 'data/2'
+ .storage.filesystems['2/2'].attachments.machines['2'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['2/2'].attachments.machines['2'].read_only = False
+ .storage.filesystems['2/2'].attachments.machines['2'].life = 'alive'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].machine = '2'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].life = 'alive'
+ .storage.filesystems['2/2'].pool = 'rootfs'
+ .storage.filesystems['2/2'].life = 'alive'
+ .storage.filesystems['2/2'].status.current = 'attached'
INFO     jubilant.wait:_juju.py:982 wait: status changed:
- .machines['0'].juju_status.current = 'started'
+ .machines['0'].juju_status.current = 'down'
+ .machines['0'].juju_status.message = 'agent is not communicating with the server'
- .apps['cassandra'].units['cassandra/0'].workload_status.current = 'active'
- .apps['cassandra'].units['cassandra/0'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/0'].workload_status.current = 'unknown'
+ .apps['cassandra'].units['cassandra/0'].workload_status.message = "agent lost, see 'juju show-status-log cassandra/0'"
+ .apps['cassandra'].units['cassandra/0'].juju_status.current = 'lost'
+ .apps['cassandra'].units['cassandra/0'].juju_status.message = 'agent is not communicating with the server'
INFO     jubilant.wait:_juju.py:982 wait: status changed:
- .apps['cassandra'].units['cassandra/0'].leader = True
- .apps['cassandra'].units['cassandra/1'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/1'].workload_status.current = 'maintenance'
+ .apps['cassandra'].units['cassandra/1'].workload_status.message = 'repairing system_auth keyspace'
+ .apps['cassandra'].units['cassandra/1'].leader = True
- .apps['cassandra'].units['cassandra/2'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/2'].workload_status.current = 'maintenance'
+ .apps['cassandra'].units['cassandra/2'].workload_status.message = 'repairing system_auth keyspace'
INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     integration.test_network:test_network.py:87 Checking: cassandra/1 if node 10.17.192.69 is down
INFO     jubilant:_juju.py:237 cli: juju ssh --model test-cas cassandra/1 'sudo snap run charmed-cassandra.nodetool status'
INFO     integration.test_network:test_network.py:87 Checking: cassandra/2 if node 10.17.192.69 is down
INFO     jubilant:_juju.py:237 cli: juju ssh --model test-cas cassandra/2 'sudo snap run charmed-cassandra.nodetool status'
INFO     jubilant:_juju.py:237 cli: juju status --model test-cas --format json
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.17.192.141:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
WARNING  cassandra.cluster:thread.py:58 Failed to create connection pool for new host 10.17.192.69:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3234, in cassandra.cluster.Session.add_or_renew_pool.run_add_or_renew_pool
  File "cassandra/pool.py", line 406, in cassandra.pool.HostConnection.__init__
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 846, in cassandra.connection.Connection.factory
  File "/root/spread_project/.tox/integration-network/lib/python3.12/site-packages/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 951, in cassandra.connection.Connection._connect_socket
OSError: [Errno None] Tried connecting to [('10.17.192.69', 9042)]. Last error: timed out
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.17.192.141:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
WARNING  cassandra.cluster:thread.py:58 Failed to create connection pool for new host 10.17.192.69:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3234, in cassandra.cluster.Session.add_or_renew_pool.run_add_or_renew_pool
  File "cassandra/pool.py", line 406, in cassandra.pool.HostConnection.__init__
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 846, in cassandra.connection.Connection.factory
  File "/root/spread_project/.tox/integration-network/lib/python3.12/site-packages/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 951, in cassandra.connection.Connection._connect_socket
OSError: [Errno None] Tried connecting to [('10.17.192.69', 9042)]. Last error: timed out
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
WARNING  cassandra.cluster:cassandra.py:71 [control connection] Error connecting to 10.17.192.69:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3577, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 846, in cassandra.connection.Connection.factory
  File "/root/spread_project/.tox/integration-network/lib/python3.12/site-packages/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 951, in cassandra.connection.Connection._connect_socket
OSError: [Errno None] Tried connecting to [('10.17.192.69', 9042)]. Last error: timed out
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.17.192.106:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
WARNING  cassandra.cluster:thread.py:58 Failed to create connection pool for new host 10.17.192.69:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3234, in cassandra.cluster.Session.add_or_renew_pool.run_add_or_renew_pool
  File "cassandra/pool.py", line 406, in cassandra.pool.HostConnection.__init__
  File "cassandra/cluster.py", line 1670, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 846, in cassandra.connection.Connection.factory
  File "/root/spread_project/.tox/integration-network/lib/python3.12/site-packages/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 951, in cassandra.connection.Connection._connect_socket
OSError: [Errno None] Tried connecting to [('10.17.192.69', 9042)]. Last error: timed out
INFO     integration.helpers.continuous_writes:continuous_writes.py:134 continuous writes min=1, max=399, pcount=399
INFO     jubilant.wait:_juju.py:982 wait: status changed:
+ .model.name = 'test-cas'
+ .model.type = 'iaas'
+ .model.controller = 'concierge-lxd'
+ .model.cloud = 'localhost'
+ .model.version = '3.6.14'
+ .model.region = 'localhost'
+ .model.model_status.current = 'available'
+ .machines['0'].juju_status.current = 'started'
+ .machines['0'].juju_status.version = '3.6.14'
+ .machines['0'].hostname = 'juju-7b13ce-0'
+ .machines['0'].dns_name = '10.17.192.69'
+ .machines['0'].ip_addresses[0] = '10.17.192.69'
+ .machines['0'].instance_id = 'juju-7b13ce-0'
+ .machines['0'].machine_status.current = 'running'
+ .machines['0'].machine_status.message = 'Running'
+ .machines['0'].modification_status.current = 'applied'
+ .machines['0'].base.name = 'ubuntu'
+ .machines['0'].base.channel = '24.04'
+ .machines['0'].network_interfaces['eth0'].ip_addresses[0] = '10.17.192.69'
+ .machines['0'].network_interfaces['eth0'].mac_address = '00:16:3e:f2:47:dd'
+ .machines['0'].network_interfaces['eth0'].is_up = True
+ .machines['0'].network_interfaces['eth0'].gateway = '10.17.192.1'
+ .machines['0'].network_interfaces['eth0'].space = 'alpha'
+ .machines['0'].constraints = 'arch=amd64'
+ .machines['0'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmnay03 virt-type=container'
+ .machines['1'].juju_status.current = 'started'
+ .machines['1'].juju_status.version = '3.6.14'
+ .machines['1'].hostname = 'juju-7b13ce-1'
+ .machines['1'].dns_name = '10.17.192.106'
+ .machines['1'].ip_addresses[0] = '10.17.192.106'
+ .machines['1'].instance_id = 'juju-7b13ce-1'
+ .machines['1'].machine_status.current = 'running'
+ .machines['1'].machine_status.message = 'Running'
+ .machines['1'].modification_status.current = 'applied'
+ .machines['1'].base.name = 'ubuntu'
+ .machines['1'].base.channel = '24.04'
+ .machines['1'].network_interfaces['eth0'].ip_addresses[0] = '10.17.192.106'
+ .machines['1'].network_interfaces['eth0'].mac_address = '00:16:3e:56:93:e5'
+ .machines['1'].network_interfaces['eth0'].is_up = True
+ .machines['1'].network_interfaces['eth0'].gateway = '10.17.192.1'
+ .machines['1'].network_interfaces['eth0'].space = 'alpha'
+ .machines['1'].constraints = 'arch=amd64'
+ .machines['1'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmnay03 virt-type=container'
+ .machines['2'].juju_status.current = 'started'
+ .machines['2'].juju_status.version = '3.6.14'
+ .machines['2'].hostname = 'juju-7b13ce-2'
+ .machines['2'].dns_name = '10.17.192.141'
+ .machines['2'].ip_addresses[0] = '10.17.192.141'
+ .machines['2'].instance_id = 'juju-7b13ce-2'
+ .machines['2'].machine_status.current = 'running'
+ .machines['2'].machine_status.message = 'Running'
+ .machines['2'].modification_status.current = 'applied'
+ .machines['2'].base.name = 'ubuntu'
+ .machines['2'].base.channel = '24.04'
+ .machines['2'].network_interfaces['eth0'].ip_addresses[0] = '10.17.192.141'
+ .machines['2'].network_interfaces['eth0'].mac_address = '00:16:3e:4e:ee:80'
+ .machines['2'].network_interfaces['eth0'].is_up = True
+ .machines['2'].network_interfaces['eth0'].gateway = '10.17.192.1'
+ .machines['2'].network_interfaces['eth0'].space = 'alpha'
+ .machines['2'].constraints = 'arch=amd64'
+ .machines['2'].hardware = 'arch=amd64 cores=0 mem=0M availability-zone=runnervmnay03 virt-type=container'
+ .apps['cassandra'].charm = 'local:cassandra-0'
+ .apps['cassandra'].charm_origin = 'local'
+ .apps['cassandra'].charm_name = 'cassandra'
+ .apps['cassandra'].charm_rev = 0
+ .apps['cassandra'].exposed = False
+ .apps['cassandra'].base.name = 'ubuntu'
+ .apps['cassandra'].base.channel = '24.04'
+ .apps['cassandra'].app_status.current = 'active'
+ .apps['cassandra'].relations['bootstrap'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['bootstrap'][0].interface = 'rolling_op'
+ .apps['cassandra'].relations['bootstrap'][0].scope = 'global'
+ .apps['cassandra'].relations['cassandra-peers'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['cassandra-peers'][0].interface = 'cassandra_peers'
+ .apps['cassandra'].relations['cassandra-peers'][0].scope = 'global'
+ .apps['cassandra'].relations['refresh-v-three'][0].related_app = 'cassandra'
+ .apps['cassandra'].relations['refresh-v-three'][0].interface = 'refresh'
+ .apps['cassandra'].relations['refresh-v-three'][0].scope = 'global'
+ .apps['cassandra'].units['cassandra/0'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/0'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/0'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/0'].machine = '0'
+ .apps['cassandra'].units['cassandra/0'].public_address = '10.17.192.69'
+ .apps['cassandra'].units['cassandra/1'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/1'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/1'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/1'].leader = True
+ .apps['cassandra'].units['cassandra/1'].machine = '1'
+ .apps['cassandra'].units['cassandra/1'].public_address = '10.17.192.106'
+ .apps['cassandra'].units['cassandra/2'].workload_status.current = 'active'
+ .apps['cassandra'].units['cassandra/2'].juju_status.current = 'idle'
+ .apps['cassandra'].units['cassandra/2'].juju_status.version = '3.6.14'
+ .apps['cassandra'].units['cassandra/2'].machine = '2'
+ .apps['cassandra'].units['cassandra/2'].public_address = '10.17.192.141'
+ .apps['cassandra'].version = '5.0.5'
+ .apps['cassandra'].endpoint_bindings[''] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['bootstrap'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cassandra-client'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cassandra-peers'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['client-certificates'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['cos-agent'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['peer-certificates'] = 'alpha'
+ .apps['cassandra'].endpoint_bindings['refresh-v-three'] = 'alpha'
+ .storage.storage['data/0'].kind = 'filesystem'
+ .storage.storage['data/0'].status.current = 'attached'
+ .storage.storage['data/0'].persistent = False
+ .storage.storage['data/0'].life = 'alive'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].machine = '0'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/0'].attachments.units['cassandra/0'].life = 'alive'
+ .storage.storage['data/1'].kind = 'filesystem'
+ .storage.storage['data/1'].status.current = 'attached'
+ .storage.storage['data/1'].persistent = False
+ .storage.storage['data/1'].life = 'alive'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].machine = '1'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/1'].attachments.units['cassandra/1'].life = 'alive'
+ .storage.storage['data/2'].kind = 'filesystem'
+ .storage.storage['data/2'].status.current = 'attached'
+ .storage.storage['data/2'].persistent = False
+ .storage.storage['data/2'].life = 'alive'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].machine = '2'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.storage['data/2'].attachments.units['cassandra/2'].life = 'alive'
+ .storage.filesystems['0/0'].size = 147718
+ .storage.filesystems['0/0'].provider_id = '0/0'
+ .storage.filesystems['0/0'].storage = 'data/0'
+ .storage.filesystems['0/0'].attachments.machines['0'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['0/0'].attachments.machines['0'].read_only = False
+ .storage.filesystems['0/0'].attachments.machines['0'].life = 'alive'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].machine = '0'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['0/0'].attachments.units['cassandra/0'].life = 'alive'
+ .storage.filesystems['0/0'].pool = 'rootfs'
+ .storage.filesystems['0/0'].life = 'alive'
+ .storage.filesystems['0/0'].status.current = 'attached'
+ .storage.filesystems['1/1'].size = 147718
+ .storage.filesystems['1/1'].provider_id = '1/1'
+ .storage.filesystems['1/1'].storage = 'data/1'
+ .storage.filesystems['1/1'].attachments.machines['1'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['1/1'].attachments.machines['1'].read_only = False
+ .storage.filesystems['1/1'].attachments.machines['1'].life = 'alive'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].machine = '1'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['1/1'].attachments.units['cassandra/1'].life = 'alive'
+ .storage.filesystems['1/1'].pool = 'rootfs'
+ .storage.filesystems['1/1'].life = 'alive'
+ .storage.filesystems['1/1'].status.current = 'attached'
+ .storage.filesystems['2/2'].size = 147718
+ .storage.filesystems['2/2'].provider_id = '2/2'
+ .storage.filesystems['2/2'].storage = 'data/2'
+ .storage.filesystems['2/2'].attachments.machines['2'].mount_point = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['2/2'].attachments.machines['2'].read_only = False
+ .storage.filesystems['2/2'].attachments.machines['2'].life = 'alive'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].machine = '2'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].location = '/var/snap/charmed-cassandra/common/var/lib/cassandra'
+ .storage.filesystems['2/2'].attachments.units['cassandra/2'].life = 'alive'
+ .storage.filesystems['2/2'].pool = 'rootfs'
+ .storage.filesystems['2/2'].life = 'alive'
+ .storage.filesystems['2/2'].status.current = 'attached'
INFO     jubilant:_juju.py:237 cli: juju ssh --model test-cas cassandra/0 'sudo snap run charmed-cassandra.nodetool status'
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.17.192.69:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.17.192.141:9042 datacenter1> discovered
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.17.192.106:9042 datacenter1> discovered
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.17.192.69:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.17.192.141:9042 datacenter1> discovered
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.17.192.106:9042 datacenter1> discovered
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.17.192.69:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.17.192.141:9042 datacenter1> discovered
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.17.192.106:9042 datacenter1> discovered
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
INFO     integration.helpers.continuous_writes:continuous_writes.py:134 continuous writes min=1, max=748, pcount=748
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.17.192.69:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.17.192.141:9042 datacenter1> discovered
INFO     cassandra.cluster:cassandra.py:71 New Cassandra host <Host: 10.17.192.106:9042 datacenter1> discovered
WARNING  cassandra.protocol:libevreactor.py:370 Server warning: Aggregation query used without partition key
INFO     integration.helpers.continuous_writes:continuous_writes.py:134 continuous writes min=1, max=748, pcount=748
INFO     integration.helpers.cassandra:cassandra.py:59 SSL context is disabled
INFO     cassandra.policies:policies.py:289 Using datacenter 'datacenter1' for DCAwareRoundRobinPolicy (via host '10.17.192.69:9042'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes