groups:
- name: cassandra.alerts
  rules:
  # ===================
  # Base Cassandra Rules
  # ===================

  - alert: Cassandra Heap Memory High
    expr: (sum by (instance)(cassandra_memory_heap_used_bytes) / sum by (instance)(cassandra_memory_heap_max_bytes)) * 100 > 80
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "Cassandra heap memory usage high (instance {{ $labels.instance }})"
      description: |
        Cassandra JVM heap memory is above 80%.
        VALUE = {{ $value }}
        LABELS = {{ $labels }}